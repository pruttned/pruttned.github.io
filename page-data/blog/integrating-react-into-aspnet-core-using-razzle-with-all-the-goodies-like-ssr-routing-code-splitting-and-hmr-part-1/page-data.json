{"componentChunkName":"component---src-templates-blog-page-js","path":"/blog/integrating-react-into-aspnet-core-using-razzle-with-all-the-goodies-like-ssr-routing-code-splitting-and-hmr-part-1","result":{"data":{"markdownRemark":{"html":"<p>To create a React application with server-side rendering (SSR) in .NET, you can usually use a well-known library, <a href=\"https://reactjs.net/\" target=\"_blank\" rel=\"nofollow noopener\">ReactJS.NET</a>. Sadly, you might miss some useful features like code splitting or HMR (<a href=\"https://webpack.js.org/concepts/hot-module-replacement/\" target=\"_blank\" rel=\"nofollow noopener\">Hot Module Replacement</a>). You are also constrained in which React libraries with SSR support you can use. E.g., in time of writing this article, there is no support for <a href=\"https://kyleamathews.github.io/typography.js/\" target=\"_blank\" rel=\"nofollow noopener\">Typography.js</a>.</p>\n<!-- end -->\n<p>What I’m going to present you in this two-part article, is an alternative way, where you have full control over the React side, while still keeping things simple thanks to <a href=\"https://github.com/jaredpalmer/razzle\" target=\"_blank\" rel=\"nofollow noopener\">Razzle</a> and <a href=\"https://github.com/JeringTech/Javascript.NodeJS\" target=\"_blank\" rel=\"nofollow noopener\">Javascript.NodeJS</a>. We will also fully embrace React and replace Razor views in the ASP.NET Core application with it.</p>\n<ul>\n<li>In the first part, we will take a quick look into Razzle. We will create a base Razzle application and integrate it with ASP.NET Core backend.</li>\n<li>In the next part, we will add data loading to both the client and the server-side. We will explore possibilities of extending our application with cool stuff like code splitting and wrap up with publishing our application using Visual Studio.</li>\n</ul>\n<h2>Why server-side rendering ?</h2>\n<p>By using server-side rendering, we can deliver HTML content with a single request. It has two main benefits. User doesn’t need to wait while all javascript assets are loaded and initialized to see the actual content, and we make it much easier for SEO bots to crawl our page.</p>\n<h2>Why Razzle</h2>\n<p>A common way to create a React application is to use <a href=\"https://github.com/facebook/create-react-app\" target=\"_blank\" rel=\"nofollow noopener\">create-react-app</a> (CRA). It allows us to focus on writing applications instead of wasting time with configuration. But sadly, it doesn’t come with server-side rendering, and without ejecting, we don’t have enough access to underlying Webpack configuration. Thankfully, there is a great alternative called <a href=\"https://github.com/jaredpalmer/razzle\" target=\"_blank\" rel=\"nofollow noopener\">Razzle</a>. Similarly to CRA, it works with zero configuration. But in contrast to CRA, Razzle gives us the power to tap into the build process and thus modify the Webpack configuration. On top of that, it comes with server-side rendering right out of the box, while still keeping server-side code in our power.</p>\n<h2>Create Razzle App</h2>\n<p>We are going to use the standard React template provided by ASP.NET Core. Although it uses CRA, it still offers useful things, like base SpaServices configuration or publish configuration. Let’s run the following command to create the base of our application.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">dotnet new react</code></pre></div>\n<p>Now we can focus on transforming CRA to Razzle. First, we will remove the whole ClientApp directory that contains the actual CRA client application and replace it with Razzle. Run the following command to initialize Razzle application inside of the ClientApp folder.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npx create-razzle-app ClientApp</code></pre></div>\n<p>We need to change the root path of SPA static files in the Startup.cs file. We will use a different path for development and production according to paths generated by Razzle.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">services<span class=\"token punctuation\">.</span><span class=\"token function\">AddSpaStaticFiles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">configuration </span><span class=\"token operator\">=></span>\n<span class=\"token punctuation\">{</span>\n    configuration<span class=\"token punctuation\">.</span>RootPath <span class=\"token operator\">=</span> _env<span class=\"token punctuation\">.</span><span class=\"token function\">IsDevelopment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"ClientApp/build\"</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">\"ClientApp/build/public\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Next, we must remove the UseSpa code from the Configure method, because we are not going to use ASP.NET Core spa proxy (more on that later).</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">app<span class=\"token punctuation\">.</span><span class=\"token function\">UseSpa</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">spa</span> <span class=\"token operator\">=></span>\n<span class=\"token punctuation\">{</span>\n  …\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Razzle architecture</h2>\n<p>Razzle application has two entry points for two different Webpack bundles:</p>\n<ul>\n<li>index.js – the entry point for the server-side bundle</li>\n<li>client.js - the entry point for the client-side bundle</li>\n</ul>\n<p>In the server.js file, we can see the actual server-side rendering inside of an Express server.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> server <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nserver\n  <span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/*'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> markup <span class=\"token operator\">=</span> <span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>StaticRouter context<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span> location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>req<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StaticRouter<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      res<span class=\"token punctuation\">.</span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;!doctype html>\n        ...\n        </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>markup<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n        ...\n        &lt;/html></span><span class=\"token template-punctuation string\">`</span></span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The App component is the root of our React application (same as with CRA). This component is converted to an HTML string using renderToString provided by React and then sent to a client inside of an HTML template.</p>\n<p>Let’s start the Razzle app to see how it works (for now without the ASP.NET Core part). Execute the following command in the ClientApp folder.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npm start</code></pre></div>\n<p>Razzle application is running on port 3000 (even if the output is saying that it is 3001 – more on that later), so let’s open <a href=\"http://localhost:3000/\" target=\"_blank\" rel=\"nofollow noopener\">http://localhost:3000/</a> in our browser. We are greeted by the default Razzle app. By opening developer tools and checking the network tab, we can see the SSR in action.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 680px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2c006094757d311acb67f1acfb3f9758/5e3e6/image1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACSklEQVQ4y41UTY/TMBDNL+UPIHHkwo3fgDghIXECicuK23LnhjiB1MKitmnTNl/OtxMn8WPerLJa0IptpKexJ+Pn8Yyfg3y1gslztHGMum2RZxn2+71itwuxDQ/YR0dEgjRNcTweFVEUIQxDZBIfJ6lwpLg5GASxOhLEEswFbdehKArEskGaJjAm10V5fmvppyUpCbnmfD4jEY66KhAcDxG2262Cu3JhVVWo61pRlqXOuWDJjoRN0yj+jQ2YHQckKsoCVjK01mogwXEnviUTxrEsxhgl5IlaKRXnjAuiysJjRjv1mKcZyzfPM6Zpupt7L1EE/4m1wwAvMc71sh4Yx1FjgnGcMM0T3DQqyQIluDcnue0HtNbJYodB4vu+x9B2GOWfQkiDzWaD+BzLMW6L/hBSQVUYFFmKJDM4RClsblBnifpZjq4qtQQBa8LaaD2kFkux78+HtkHYOXzvPWLncV15PD95fCw9vnZy/NnjSyPl6S0CXPiZ3uFKiF6mwLMz8CoHXiTA0xPwvgJ+yGaTlaawVo9Bm+Gc2reFx6fa40nk8U7Gb4zHL8dOjVqa/2ZIssX2zun4ugM+C16XYi3woQYkcYzSIKrr0QzvCKXDXVMjqhp8My3mrsXaVPhZW41hxymMi47Mjw1ardfY3NzgHO6wEWX9Xss7IFL8i/DSpgxykUvReC7XJZObUYqKiEJUttxbKiugBvkYLFrkmDKiZQAtsciPml4eAz4UtE7qywz1HtLBVPmTgQQfgNPppD5a+nhkZvkQFr3T/gGWTMqektRuogAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SSR in action\"\n        title=\"SSR in action\"\n        src=\"/static/2c006094757d311acb67f1acfb3f9758/5e3e6/image1.png\"\n        srcset=\"/static/2c006094757d311acb67f1acfb3f9758/924ad/image1.png 170w,\n/static/2c006094757d311acb67f1acfb3f9758/6103d/image1.png 340w,\n/static/2c006094757d311acb67f1acfb3f9758/5e3e6/image1.png 680w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The document returned from the server contains fully rendered HTML. If we make any change to the Home.js component, it gets updated in the browser automatically. So HMR is also working.</p>\n<p>Now, what’s up with the <a href=\"http://localhost:3001/\" target=\"_blank\" rel=\"nofollow noopener\">http://localhost:3001</a>? Razzle uses a smart trick to achieve client-side HMR and blazing fast recompiles during development. It runs a separate webpack-dev-server for client-side assets. To connect these assets with the server-side, Razzle explicitly sets “webpack.output.publicPath” to localhost:3001. Therefore if we examine the rendered HTML from <a href=\"http://localhost:3000/\" target=\"_blank\" rel=\"nofollow noopener\">http://localhost:3000</a>, we can see that scripts (alongside other assets) are actually hosted on <a href=\"http://localhost:3001/\" target=\"_blank\" rel=\"nofollow noopener\">http://localhost:3001</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 628px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6104ed5712e6c3d28f5fcac6debc49b3/83cbb/image2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.687898089171973%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABDklEQVQY022R6WrDMBCE8/4PV/qjN83hQ4otx1biQ5FjyV83Lm0hzcIwsGiHmdFqdCOHpMLkW0xZovaWrmvxvWOaIjFEQvjmGKPs5gUhztzOPM+sxvOIVTVtbdDpAbUuKLc5+mNHtq7I9z2Fcaiix9SeurI0grax+KHlIve+94vYdUTQ0xlx1DWUa0368Il+Ejy+c0oLBh9xYxQOC88xQJzE8YVp9IQpCE9/gtcoOtdUhWZw8kCWFzkK/ESabwD/w/5mFkE5VrkizxRt29JLf13XLX3dk7s6uY9Fj5W1Dr2pl16O0ktZOezpzKG0JK+K5E2zfVFsnnN2yZG0GtloR2Y8qWBXnDFH+Yd6wDaOL8G0zuzwLDorAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"publicPath in action\"\n        title=\"publicPath in action\"\n        src=\"/static/6104ed5712e6c3d28f5fcac6debc49b3/83cbb/image2.png\"\n        srcset=\"/static/6104ed5712e6c3d28f5fcac6debc49b3/924ad/image2.png 170w,\n/static/6104ed5712e6c3d28f5fcac6debc49b3/6103d/image2.png 340w,\n/static/6104ed5712e6c3d28f5fcac6debc49b3/83cbb/image2.png 628w\"\n        sizes=\"(max-width: 628px) 100vw, 628px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>This trick is going to be quite helpful. Webpack will serve client-side assets for us independently of our ASP.NET Core side, and therefore, we will have HMR without any hassle. We won’t even need to use a proxy between ASP.NET Core and Webpack dev server in contrast to a CRA solution.</p>\n<h2>Extending Razzle app</h2>\n<p>Let’s extend our application a little bit to be able to experiment with routing. For that, we will replace the Home.js component with two other components - HeroList.js and HeroDetail.js. For now, these will be just dummy components and we will extend them later.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">const HeroList </span><span class=\"token operator\">=</span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token parameter\"> </span><span class=\"token operator\">=></span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>List <span class=\"token keyword\">of</span> heroes<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token constant\">TODO</span><span class=\"token punctuation\">:</span> list \n          <span class=\"token operator\">&lt;</span>ul<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>li<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/1\"</span><span class=\"token operator\">></span>Hero <span class=\"token number\">1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function-variable function\">const HeroDetail </span><span class=\"token operator\">=</span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token parameter\"> </span><span class=\"token operator\">=></span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>Hero <span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">></span>Back to list<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token constant\">TODO</span><span class=\"token punctuation\">:</span> Hero detail\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We also need to create routes for our new components in App.js.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>Switch<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Route exact path<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>HeroList<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Route exact path<span class=\"token operator\">=</span><span class=\"token string\">\"/:id\"</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>HeroDetail<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Switch<span class=\"token operator\">></span></code></pre></div>\n<p>Let’s check the <a href=\"http://localhost:3000/\" target=\"_blank\" rel=\"nofollow noopener\">http://localhost:3000/</a>. We can see the HeroList component rendered, and clicking on the “Hero 1” link brings us to HeroDetail, as you would expect.</p>\n<h2>ASP.NET Core integration</h2>\n<p>We have successfully created a base of our application, but the client-side (React/Razzle) and the server-side (ASP.NET Core) are still disconnected. It’s time to integrate both sides by introducing React server-side rendering into the ASP.NET Core backend.</p>\n<h3>Rendering to string</h3>\n<p>We need to execute React rendering from the ASP.NET Core backend, but Razzle provides server-side rendering through an Express server by default. An easy way to achieve this integration is to use <a href=\"https://github.com/JeringTech/Javascript.NodeJS\" target=\"_blank\" rel=\"nofollow noopener\">Javascript.NodeJS</a> library that enables us to call NodeJs scripts from .NET Core. We only need to replace the Express server with a simple function that just returns the rendered HTML.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">const server </span><span class=\"token operator\">=</span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span>cb<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span><span class=\"token parameter\"> </span><span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> markup <span class=\"token operator\">=</span><span class=\"token function\"> renderToString</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>StaticRouter context<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span> location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>url<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StaticRouter<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n<span class=\"token function\">  cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;!doctype html>\n      &lt;html lang=\"\">\n      &lt;head>\n          &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n          &lt;meta charset=\"utf-8\" />\n          &lt;title>Welcome to Razzle&lt;/title>\n          &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n          </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>assets<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>css\n      <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;link rel=\"stylesheet\" href=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>assets<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>css<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token template-punctuation string\">`</span></span>\n      <span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> \n          </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'production'</span>\n      <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;script src=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>assets<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>js<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\" defer>&lt;/script></span><span class=\"token template-punctuation string\">`</span></span>\n      <span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;script src=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>assets<span class=\"token punctuation\">.</span>client<span class=\"token punctuation\">.</span>js<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\" defer crossorigin>&lt;/script></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n      &lt;/head>\n      &lt;body>\n          &lt;div id=\"root\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>markup<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/div>\n      &lt;/body>\n    &lt;/html></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The first parameter (cb) is a callback function to signal async completion to Javascript.NodeJS.</p>\n<p>The entry point for the server-side is index.js, so we need to modify that one too.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> app <span class=\"token operator\">=</span><span class=\"token function\"> require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">;</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> app<span class=\"token punctuation\">;</span></code></pre></div>\n<p>We have removed all of the original code, and now we are just exporting the server.</p>\n<p>We can now try out the server function. First, we need to build the Razzle application with the following command.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npm run build</code></pre></div>\n<p>This command generates a production bundle of our application in the “./build/server” directory. It includes the server.js file that contains the whole application built by Webpack.</p>\n<p>To call the server function, just run the following command.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">node -p &quot;require(&#39;./build/server&#39;)((_,x)=&gt;console.log(x), &#39;/&#39;)&quot;</code></pre></div>\n<p>Great, we can see the rendered HTML of our React application. We are making some progress, but we surely don’t want to call build each time we change something in our React part during development. Luckily, Razzle does this automatically for us when we start the application in development mode. There is just one little catch. Razzle creates a bundle that also contains server-side HMR, and it will get in our way. If we try to run our rendering function from the server.js generated in the development mode, it will keep running and waiting for changes. Therefore, we need to remove it. Thankfully, we can keep the client-side HMR, which is more significant for us. To remove the server-side HMR, we need to tap into the underlying Webpack configuration by creating a “razzle.config.js” file with a “modify” function.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n<span class=\"token function-variable function\">    modify</span><span class=\"token punctuation\">:</span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> target<span class=\"token punctuation\">,</span> dev <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token parameter\"> </span><span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span>target <span class=\"token operator\">===</span> <span class=\"token string\">'node'</span> <span class=\"token operator\">&amp;&amp;</span> dev<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            config<span class=\"token punctuation\">.</span>plugins <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span>plugins<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">p </span><span class=\"token operator\">=></span><span class=\"token class-name\"> p</span><span class=\"token punctuation\">.</span>constructor<span class=\"token punctuation\">.</span>name <span class=\"token operator\">!==</span> <span class=\"token string\">'HotModuleReplacementPlugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            config<span class=\"token punctuation\">.</span>entry <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span>entry<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e </span><span class=\"token operator\">=></span> e <span class=\"token operator\">!==</span> <span class=\"token string\">'webpack/hot/poll?300'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> config<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now, after we have disabled the server-side HMR, we are ready to start the development server again with the following command.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">npm start</code></pre></div>\n<p>We can also try to rerun the server function.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">node -p &quot;require(&#39;./build/server&#39;)((_,x)=&gt;console.log(x), &#39;/&#39;)&quot;</code></pre></div>\n<p>It prints HTML, same as in case of production bundle, but now, we can make changes to our React components, and by rerunning the command, we can see that the bundle was updated.</p>\n<h3>Calling NodeJs from ASP.NET Core</h3>\n<p>Finally, we are ready to integrate our React client-side with the ASP.NET Core backend. For now, we will do it without any data coming from the ASP.NET Core backend.</p>\n<p>We are going to use the already mentioned <a href=\"https://github.com/JeringTech/Javascript.NodeJS\" target=\"_blank\" rel=\"nofollow noopener\">Javascript.NodeJS</a> library to call server.js from ASP.NET Core backend. So, let’s add it to our project through NuGet.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">dotnet add package Jering.Javascript.NodeJS --version 5.4.0</code></pre></div>\n<p>We need to register it in the ConfigureServices method inside of the Startup.cs file.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\">services<span class=\"token punctuation\">.</span><span class=\"token function\">AddNodeJS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nservices<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">Configure</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OutOfProcessNodeJSServiceOptions</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>options <span class=\"token operator\">=></span>\n<span class=\"token punctuation\">{</span>\n    options<span class=\"token punctuation\">.</span>EnableFileWatching <span class=\"token operator\">=</span> _env<span class=\"token punctuation\">.</span><span class=\"token function\">IsDevelopment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Well, that was rather simple, and we are ready to go. Let’s create a service for calling our function exported from server.js.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RenderService</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">IRenderService</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">string</span> ServerJsRelPath <span class=\"token operator\">=</span> <span class=\"token string\">\"./ClientApp/build/server.js\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token class-name\">INodeJSService</span> _nodeJSService<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token keyword\">string</span> _serverJsPath<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token function\">RenderService</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">INodeJSService</span> nodeJSService<span class=\"token punctuation\">,</span> <span class=\"token class-name\">IWebHostEnvironment</span> webHostEnvironment<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        _nodeJSService <span class=\"token operator\">=</span> nodeJSService<span class=\"token punctuation\">;</span>\n        _serverJsPath <span class=\"token operator\">=</span> webHostEnvironment<span class=\"token punctuation\">.</span>ContentRootFileProvider<span class=\"token punctuation\">.</span><span class=\"token function\">GetFileInfo</span><span class=\"token punctuation\">(</span>ServerJsRelPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>PhysicalPath<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> Task<span class=\"token operator\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token operator\">></span> <span class=\"token function\">RenderAsync</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span> url<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> \n        _nodeJSService<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">InvokeFromFileAsync</span><span class=\"token punctuation\">&lt;</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>_serverJsPath<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> url <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We are using ContentRootFileProvider.GetFileInfo to get the path to the server.js file. In RenderAsync, we are calling Javascript.NodeJS (InvokeFromFileAsync) to invoke the exported function in the server.js file. InvokeFromFileAsync returns whatever we send to the callback (cb) in the js function. In our case, it is HTML of the specified route provided as the “url” parameter.</p>\n<p>We can now create a custom action result for executing React rendering from MVC actions.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SsrResult</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">IActionResult</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token keyword\">string</span> _url<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token function\">SsrResult</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span> url<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        _url <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">async</span> <span class=\"token class-name\">Task</span> <span class=\"token function\">ExecuteResultAsync</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ActionContext</span> context<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> renderService <span class=\"token operator\">=</span> context<span class=\"token punctuation\">.</span>HttpContext<span class=\"token punctuation\">.</span>RequestServices<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetRequiredService</span><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">IRenderService</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> renderResult <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> renderService<span class=\"token punctuation\">.</span><span class=\"token function\">RenderAsync</span><span class=\"token punctuation\">(</span>_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">var</span> contentResult <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ContentResult</span>\n        <span class=\"token punctuation\">{</span>\n            Content <span class=\"token operator\">=</span> renderResult<span class=\"token punctuation\">,</span>\n            ContentType <span class=\"token operator\">=</span> <span class=\"token string\">\"text/html\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">await</span> contentResult<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteResultAsync</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Here we are calling our render service and converting its result into a ContentResult.</p>\n<p>We have everything ready to create the actual hero controller.</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre class=\"language-cs\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HeroController</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Controller</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">[</span><span class=\"token class-name\">Route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">IActionResult</span> <span class=\"token function\">Index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SsrResult</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token punctuation\">[</span><span class=\"token class-name\">Route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/{id:int}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">IActionResult</span> <span class=\"token function\">Detail</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> id<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SsrResult</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/:id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For now, it is rather simple. We have defined two routes that just return the SSR action result.</p>\n<p>We have everything ready to try out our application. Open <a href=\"https://localhost:5001/\" target=\"_blank\" rel=\"nofollow noopener\">https://localhost:5001/</a>, which is the default development URL of ASP.NET Core applications. In the network tab of developer tools, we can see that we are receiving a complete HTML from the backend, so the SSR is working.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 680px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8e32c856f0704f89ef49a933cf0412d3/7315d/image3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.51020408163265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAACToAAAk6AGCYwUcAAABB0lEQVQoz4VS2W6EMAzM/39eH7ZICwUV0ALhvsIRmMZWqaAC1tLIITaT8SQCv7GuK+5iK9cKWG5aRd/3GIYBlDcopTg3TYO2bVFVFa+rssArkvxd14QGXdeZXP/1Cs/zEEURpJQHJEnCuSxLhGGINE3hfEf4sL4QvCT/Q6B6HMfcT8RMGAQBFzaQgqIoWOm72FtFa3HXuCwLq/B9n1Xaz6c53GfQeFvfHuL/xnYikWmteRTXdQ08OI4Dy7LweHwiy7LTy7wlnOeZL4e8JH+maTod96DwyhMiJALyMc9z421tblTxPmFPdlB4RUh5HEfOpNS2tfETO0UX7/CdQvKRQuuVsR/xLH4AJjYMNaWMlBUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"HTML rendered from the .NET backend\"\n        title=\"HTML rendered from the .NET backend\"\n        src=\"/static/8e32c856f0704f89ef49a933cf0412d3/5e3e6/image3.png\"\n        srcset=\"/static/8e32c856f0704f89ef49a933cf0412d3/924ad/image3.png 170w,\n/static/8e32c856f0704f89ef49a933cf0412d3/6103d/image3.png 340w,\n/static/8e32c856f0704f89ef49a933cf0412d3/5e3e6/image3.png 680w,\n/static/8e32c856f0704f89ef49a933cf0412d3/89b07/image3.png 1020w,\n/static/8e32c856f0704f89ef49a933cf0412d3/7315d/image3.png 1225w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>SSL</h3>\n<p>We have only one small problem left. In development, Razzle serves scripts through HTTP, while ASP.NET Core uses SSL by default. This inconsistency is going to be a problem for us because all modern browsers today disallow mixed content for security reasons. To force Razzle to use SSL, we need to tap into the Webpack configuration again using the “modify” function in razzle.config.js.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dev</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    config<span class=\"token punctuation\">.</span>output<span class=\"token punctuation\">.</span>publicPath <span class=\"token operator\">=</span> config<span class=\"token punctuation\">.</span>output<span class=\"token punctuation\">.</span>publicPath<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'https://'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token function\"> </span><span class=\"token punctuation\">(</span>target <span class=\"token operator\">===</span> <span class=\"token string\">'web'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        config<span class=\"token punctuation\">.</span>devServer<span class=\"token punctuation\">.</span>https <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n        config<span class=\"token punctuation\">.</span>devServer<span class=\"token punctuation\">.</span>pfx <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">RAZZLE_PFX</span><span class=\"token punctuation\">;</span>\n        config<span class=\"token punctuation\">.</span>devServer<span class=\"token punctuation\">.</span>pfxPassphrase <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">RAZZLE_PFX_PASSPHRASE</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>First, we are setting publicPath, because HTTP is hardcoded in the Razzle configuration (see <a href=\"https://github.com/jaredpalmer/razzle/blob/2535fbcfc8d8f99d9d0ada4eaed3e994335f2af4/packages/razzle/config/createConfig.js#L90\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/jaredpalmer/razzle/blob/2535fbcfc8d8f99d9d0ada4eaed3e994335f2af4/packages/razzle/config/createConfig.js#L90</a>). Then we are telling Webpack dev server to serve content through HTTPS and which certificate to use. For more info about SSL in the Webpack dev server, please see <a href=\"https://webpack.js.org/configuration/dev-server/#devserverhttps\" target=\"_blank\" rel=\"nofollow noopener\">https://webpack.js.org/configuration/dev-server/#devserverhttps</a>.</p>\n<p>For storing the certificate configuration, we can use “.env” file. Razzle is then going to provide all keys with the “RAZZLE_” prefix to “process.env” automatically.</p>\n<p>Alternatively, we could also just switch the ASP.NET Core backend to HTTP by removing <a href=\"https://localhost:5001\" target=\"_blank\" rel=\"nofollow noopener\">https://localhost:5001</a> URL from the launchSettings.json file.</p>\n<h2>Conclusion</h2>\n<p>We are going to wrap it here for now. We have successfully integrated Razzle with ASP.NET Core backend into a working application with server-side rendering while having HMR during development.</p>\n<p>Next time, we are going to add data loading, look into code splitting, and also tackle the problem of deploying our application.</p>","timeToRead":12,"frontmatter":{"date":"June 26, 2020","path":"/blog/integrating-react-into-aspnet-core-using-razzle-with-all-the-goodies-like-ssr-routing-code-splitting-and-hmr-part-1","title":"Integrating React into ASP.NET Core using Razzle with all the goodies like SSR, routing, code splitting, and HMR – Part 1/2","featuredImage":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAME/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgED/9oADAMBAAIQAxAAAAHPK+ZZgp//xAAWEAEBAQAAAAAAAAAAAAAAAAABIEH/2gAIAQEAAQUCxSf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPwEn/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAExURARgcH/2gAIAQEAAT8h1OB6+4fhQj//2gAMAwEAAgADAAAAEMzf/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QZ//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QH//EABwQAAICAgMAAAAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPxA7OFh2uuYQTMgIUUJOg5gPc3GE/9k=","aspectRatio":2.2666666666666666,"src":"/static/c0c93268eff42ce94ecb018213e32840/bc3a8/featured.jpg","srcSet":"/static/c0c93268eff42ce94ecb018213e32840/d278e/featured.jpg 200w,\n/static/c0c93268eff42ce94ecb018213e32840/8539d/featured.jpg 400w,\n/static/c0c93268eff42ce94ecb018213e32840/bc3a8/featured.jpg 800w,\n/static/c0c93268eff42ce94ecb018213e32840/81ef8/featured.jpg 1200w,\n/static/c0c93268eff42ce94ecb018213e32840/10fb1/featured.jpg 1360w","sizes":"(max-width: 800px) 100vw, 800px"},"fixed":{"src":"/static/c0c93268eff42ce94ecb018213e32840/bc3a8/featured.jpg"}}},"featuredImageBy":"Tim Bogdanov","featuredImageByUrl":"https://unsplash.com/@timbog80?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","featuredImageSite":"Unsplash","featuredImageSiteUrl":"https://unsplash.com/s/photos/bridge?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}